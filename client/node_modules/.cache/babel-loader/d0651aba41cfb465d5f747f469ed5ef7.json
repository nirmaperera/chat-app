{"ast":null,"code":"import _toConsumableArray from\"/Users/nirmaperera/Desktop/chat-app/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/nirmaperera/Desktop/chat-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useEffect,useState}from'react';import{Link,useHistory}from'react-router-dom';import queryString from'query-string';import io from'socket.io-client';import InfoBar from'../InforBar/InforBar';import InputMenu from'../InputMenu/InputMenu';import Input from'../Input/Input';import Messages from'../Messages/Messages';import TextContainer from'../TextContainer/TextContainer';import DotLoader from\"react-spinners/DotLoader\";import errorImg from'../../assets/images/error.png';import'./Chat.scss';var ENDPOINT='https://chat-application23.herokuapp.com/';//const ENDPOINT = 'localhost:5000';\nvar socket;var Chat=function Chat(_ref){var location=_ref.location;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),room=_useState4[0],setRoom=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),users=_useState6[0],setUsers=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),message=_useState8[0],setMessage=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),messages=_useState10[0],setMessages=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),error=_useState12[0],setError=_useState12[1];var _useState13=useState(true),_useState14=_slicedToArray(_useState13,2),openMenu=_useState14[0],setOpenMenu=_useState14[1];var _useState15=useState(true),_useState16=_slicedToArray(_useState15,2),loading=_useState16[0],setLoading=_useState16[1];window.scrollTo(0,0);var history=useHistory();useEffect(function(){var _queryString$parse=queryString.parse(location.search),name=_queryString$parse.name,room=_queryString$parse.room;socket=io(ENDPOINT);console.log(socket,'SOCKET');setLoading(false);setRoom(room);setName(name);socket.emit('join',{name:name,room:room},function(error){if(error){setError(true);}});socket.on('connect_error',function(error){alert('Server is currently down :( Please come back later!');socket.disconnect();history.push('/');});},[ENDPOINT,location.search]);useEffect(function(){socket.on('message',function(message){setMessages(function(messages){return[].concat(_toConsumableArray(messages),[message]);});});socket.on(\"roomData\",function(_ref2){var users=_ref2.users;setUsers(users);});},[]);var sendMessage=function sendMessage(event){event.preventDefault();console.log(message,'MESSAGES');var time=new Date().toLocaleTimeString();if(message){socket.emit('sendMessage',message,time,function(){return setMessage('');});}};return/*#__PURE__*/_jsx(\"div\",{className:\"chat\",children:loading?/*#__PURE__*/_jsx(DotLoader,{size:150,color:\"#69D1D1\",loading:loading}):/*#__PURE__*/_jsx(\"div\",{style:{width:\"100%\",height:\"100%\"},children:error?/*#__PURE__*/_jsxs(\"div\",{className:\"chat__error\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\" \",/*#__PURE__*/_jsx(\"img\",{src:errorImg,alt:\"error\"})]}),/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsx(\"button\",{children:\" Join TeleChat! \"})})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"chatInner\",children:[/*#__PURE__*/_jsx(TextContainer,{users:users,name:name,room:room,setOpenMenu:setOpenMenu,menu:openMenu}),/*#__PURE__*/_jsx(\"div\",{className:\"chatInner__main\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"chatInner__inner\",children:[/*#__PURE__*/_jsx(InfoBar,{room:room,setOpenMenu:setOpenMenu,menu:openMenu}),/*#__PURE__*/_jsx(Messages,{messages:messages,name:name}),/*#__PURE__*/_jsx(InputMenu,{setMessage:setMessage}),/*#__PURE__*/_jsx(Input,{message:message,setMessage:setMessage,sendMessage:sendMessage})]})})]})})});};export default Chat;","map":{"version":3,"sources":["/Users/nirmaperera/Desktop/chat-app/client/src/components/Chat/Chat.js"],"names":["React","useEffect","useState","Link","useHistory","queryString","io","InfoBar","InputMenu","Input","Messages","TextContainer","DotLoader","errorImg","ENDPOINT","socket","Chat","location","name","setName","room","setRoom","users","setUsers","message","setMessage","messages","setMessages","error","setError","openMenu","setOpenMenu","loading","setLoading","window","scrollTo","history","parse","search","console","log","emit","on","alert","disconnect","push","sendMessage","event","preventDefault","time","Date","toLocaleTimeString","width","height"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport queryString from 'query-string';\nimport io from 'socket.io-client';\n\nimport InfoBar from '../InforBar/InforBar';\nimport InputMenu from '../InputMenu/InputMenu';\nimport Input from '../Input/Input';\nimport Messages from '../Messages/Messages';\nimport TextContainer from '../TextContainer/TextContainer';\nimport DotLoader from \"react-spinners/DotLoader\";\nimport errorImg from '../../assets/images/error.png';\nimport './Chat.scss';\n\nconst ENDPOINT = 'https://chat-application23.herokuapp.com/'\n//const ENDPOINT = 'localhost:5000';\n\nlet socket;\n\nconst Chat = ({ location }) => {\n\tconst [name, setName] = useState('');\n\tconst [room, setRoom] = useState('');\n\tconst [users, setUsers] = useState('');\n\tconst [message, setMessage] = useState('');\n\tconst [messages, setMessages] = useState([]);\n\tconst [error, setError] = useState(false);\n\tconst [openMenu, setOpenMenu] = useState(true)\n\tconst [loading, setLoading] = useState(true);\n\twindow.scrollTo(0, 0);\n\tconst history = useHistory();\n\n\tuseEffect(() => {\n\t\tconst { name, room } = queryString.parse(location.search);\n\n\t\tsocket = io(ENDPOINT);\n\t\tconsole.log(socket, 'SOCKET');\n\t\tsetLoading(false);\n\n\t\tsetRoom(room);\n\t\tsetName(name)\n\n\t\tsocket.emit('join', { name, room }, (error) => {\n\t\t\tif (error) {\n\t\t\t\tsetError(true)\n\t\t\t}\n\t\t});\n\n\t\tsocket.on('connect_error', (error) => {\n\t\t\talert('Server is currently down :( Please come back later!');\n\t\t\tsocket.disconnect()\n\t\t\thistory.push('/')\n\t\t});\n\n\t}, [ENDPOINT, location.search]);\n\n\tuseEffect(() => {\n\t\tsocket.on('message', message => {\n\t\t\tsetMessages(messages => [...messages, message]);\n\t\t});\n\n\t\tsocket.on(\"roomData\", ({ users }) => {\n\t\t\tsetUsers(users);\n\t\t});\n\t}, []);\n\n\tconst sendMessage = (event) => {\n\t\tevent.preventDefault();\n\t\tconsole.log(message, 'MESSAGES')\n\t\tconst time = new Date().toLocaleTimeString();\n\n\t\tif (message) {\n\t\t\tsocket.emit('sendMessage', message, time, () => setMessage(''));\n\t\t}\n\t}\n\n\treturn (\n\t\t<div className=\"chat\">\n\t\t\t{loading ? <DotLoader\n\n\t\t\t\tsize={150}\n\t\t\t\tcolor={\"#69D1D1\"}\n\t\t\t\tloading={loading}\n\t\t\t/> :\n\t\t\t\t<div style={{ width: \"100%\", height: \"100%\" }}>\n\t\t\t\t\t{error ? <div className=\"chat__error\">\n\t\t\t\t\t\t<div> <img src={errorImg} alt=\"error\"></img></div>\n\t\t\t\t\t\t<Link to={\"/\"}>\n\t\t\t\t\t\t\t<button> Join TeleChat! </button>\n\t\t\t\t\t\t</Link>\n\n\t\t\t\t\t</div> :\n\t\t\t\t\t\t<div className=\"chatInner\">\n\t\t\t\t\t\t\t<TextContainer users={users} name={name} room={room} setOpenMenu={setOpenMenu} menu={openMenu} />\n\t\t\t\t\t\t\t<div className=\"chatInner__main\">\n\t\t\t\t\t\t\t\t<div className=\"chatInner__inner\">\n\t\t\t\t\t\t\t\t\t<InfoBar room={room} setOpenMenu={setOpenMenu} menu={openMenu} />\n\t\t\t\t\t\t\t\t\t<Messages messages={messages} name={name} />\n\t\t\t\t\t\t\t\t\t<InputMenu setMessage={setMessage} />\n\t\t\t\t\t\t\t\t\t<Input message={message} setMessage={setMessage} sendMessage={sendMessage} />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t}\n\n\t\t\t\t</div>}\n\n\t\t</div>\n\t);\n}\n\nexport default Chat;\n"]},"metadata":{},"sourceType":"module"}