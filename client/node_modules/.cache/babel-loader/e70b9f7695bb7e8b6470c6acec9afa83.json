{"ast":null,"code":"import _toConsumableArray from\"/Users/nirmaperera/Desktop/chat-app/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/nirmaperera/Desktop/chat-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useEffect,useState}from'react';import{Link,useHistory}from'react-router-dom';import queryString from'query-string';import io from'socket.io-client';import InfoBar from'../InforBar/InforBar';import InputMenu from'../InputMenu/InputMenu';import Input from'../Input/Input';import Messages from'../Messages/Messages';import TextContainer from'../TextContainer/TextContainer';import DotLoader from\"react-spinners/DotLoader\";import errorImg from'../../assets/images/error.png';import'./Chat.scss';var ENDPOINT='https://chat-application23.herokuapp.com/';//const ENDPOINT = 'localhost:5000';\nvar socket;var Chat=function Chat(_ref){var location=_ref.location;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),room=_useState4[0],setRoom=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),users=_useState6[0],setUsers=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),message=_useState8[0],setMessage=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),messages=_useState10[0],setMessages=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),error=_useState12[0],setError=_useState12[1];var _useState13=useState(true),_useState14=_slicedToArray(_useState13,2),openMenu=_useState14[0],setOpenMenu=_useState14[1];var _useState15=useState(true),_useState16=_slicedToArray(_useState15,2),loading=_useState16[0],setLoading=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),themeDark=_useState18[0],setThemeDark=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),typing=_useState20[0],setTyping=_useState20[1];var _useState21=useState(''),_useState22=_slicedToArray(_useState21,2),typeMess=_useState22[0],setTypeMess=_useState22[1];var history=useHistory();useEffect(function(){var _queryString$parse=queryString.parse(location.search),name=_queryString$parse.name,room=_queryString$parse.room;socket=io(ENDPOINT);console.log(socket,'SOCKET');setRoom(room);setName(name);socket.emit('join',{name:name,room:room},function(error){if(error){setError(true);}setLoading(false);});if(typing){socket.emit('typing',name);}socket.on('connect_error',function(error){alert('Server is currently down :( Please come back later!');socket.disconnect();history.push('/');});},[ENDPOINT,location.search]);useEffect(function(){socket.on('message',function(message){setMessages(function(messages){return[].concat(_toConsumableArray(messages),[message]);});});socket.on(\"roomData\",function(_ref2){var users=_ref2.users;setUsers(users);});},[]);useEffect(function(){socket.on('typing',function(typeMess){setTypeMess(typeMess.data);});},[name,typeMess]);var isTyping=function isTyping(typing){socket.emit('typing',name,typing,function(){return setTypeMess('');});};var sendMessage=function sendMessage(event){event.preventDefault();var time=new Date().toLocaleTimeString();if(message){socket.emit('sendMessage',message,time,function(){return setMessage('');});}};return/*#__PURE__*/_jsx(\"div\",{className:themeDark?'chat chat__dark':'chat chat__light',children:loading?/*#__PURE__*/_jsxs(\"div\",{style:{margin:\"0 auto\"},children:[/*#__PURE__*/_jsx(DotLoader,{size:150,color:\"#69D1D1\",loading:loading}),/*#__PURE__*/_jsx(\"p\",{className:\"chat__loading\",children:\"Setting up your chat room ... \"})]}):/*#__PURE__*/_jsx(\"div\",{style:{width:\"100%\",height:\"100%\"},children:error?/*#__PURE__*/_jsxs(\"div\",{className:\"chat__error\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\" \",/*#__PURE__*/_jsx(\"img\",{src:errorImg,alt:\"error\"})]}),/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsx(\"button\",{children:\" Join TeleChat! \"})})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"chatInner\",children:[/*#__PURE__*/_jsx(TextContainer,{users:users,userName:name,room:room,setOpenMenu:setOpenMenu,menu:openMenu,themeDark:themeDark,setThemeDark:setThemeDark}),/*#__PURE__*/_jsx(\"div\",{className:\"chatInner__main\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"chatInner__inner\",children:[/*#__PURE__*/_jsx(InfoBar,{room:room,setOpenMenu:setOpenMenu,menu:openMenu,themeDark:themeDark}),/*#__PURE__*/_jsx(Messages,{messages:messages,name:name,themeDark:themeDark}),typeMess?/*#__PURE__*/_jsx(\"p\",{className:themeDark?\"chatInner__typing dark__typing\":\"chatInner__typing light__typing\",children:typeMess}):null,/*#__PURE__*/_jsx(InputMenu,{setMessage:setMessage,themeDark:themeDark}),/*#__PURE__*/_jsx(Input,{message:message,setMessage:setMessage,sendMessage:sendMessage,themeDark:themeDark,setTyping:setTyping,isTyping:isTyping})]})})]})})});};export default Chat;","map":{"version":3,"sources":["/Users/nirmaperera/Desktop/chat-app/client/src/components/Chat/Chat.js"],"names":["React","useEffect","useState","Link","useHistory","queryString","io","InfoBar","InputMenu","Input","Messages","TextContainer","DotLoader","errorImg","ENDPOINT","socket","Chat","location","name","setName","room","setRoom","users","setUsers","message","setMessage","messages","setMessages","error","setError","openMenu","setOpenMenu","loading","setLoading","themeDark","setThemeDark","typing","setTyping","typeMess","setTypeMess","history","parse","search","console","log","emit","on","alert","disconnect","push","data","isTyping","sendMessage","event","preventDefault","time","Date","toLocaleTimeString","margin","width","height"],"mappings":"0VAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,IAAT,CAAeC,UAAf,KAAiC,kBAAjC,CACA,MAAOC,CAAAA,WAAP,KAAwB,cAAxB,CACA,MAAOC,CAAAA,EAAP,KAAe,kBAAf,CAEA,MAAOC,CAAAA,OAAP,KAAoB,sBAApB,CACA,MAAOC,CAAAA,SAAP,KAAsB,wBAAtB,CACA,MAAOC,CAAAA,KAAP,KAAkB,gBAAlB,CACA,MAAOC,CAAAA,QAAP,KAAqB,sBAArB,CACA,MAAOC,CAAAA,aAAP,KAA0B,gCAA1B,CACA,MAAOC,CAAAA,SAAP,KAAsB,0BAAtB,CACA,MAAOC,CAAAA,QAAP,KAAqB,+BAArB,CACA,MAAO,aAAP,CAEA,GAAMC,CAAAA,QAAQ,CAAG,2CAAjB,CACA;AAEA,GAAIC,CAAAA,MAAJ,CAEA,GAAMC,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,MAAkB,IAAfC,CAAAA,QAAe,MAAfA,QAAe,eACNf,QAAQ,CAAC,EAAD,CADF,wCACvBgB,IADuB,eACjBC,OADiB,8BAENjB,QAAQ,CAAC,EAAD,CAFF,yCAEvBkB,IAFuB,eAEjBC,OAFiB,8BAGJnB,QAAQ,CAAC,EAAD,CAHJ,yCAGvBoB,KAHuB,eAGhBC,QAHgB,8BAIArB,QAAQ,CAAC,EAAD,CAJR,yCAIvBsB,OAJuB,eAIdC,UAJc,8BAKEvB,QAAQ,CAAC,EAAD,CALV,0CAKvBwB,QALuB,gBAKbC,WALa,gCAMJzB,QAAQ,CAAC,KAAD,CANJ,2CAMvB0B,KANuB,gBAMhBC,QANgB,gCAOE3B,QAAQ,CAAC,IAAD,CAPV,2CAOvB4B,QAPuB,gBAObC,WAPa,gCAQA7B,QAAQ,CAAC,IAAD,CARR,2CAQvB8B,OARuB,gBAQdC,UARc,gCASI/B,QAAQ,CAAC,KAAD,CATZ,2CASvBgC,SATuB,gBASZC,YATY,gCAUFjC,QAAQ,CAAC,KAAD,CAVN,2CAUvBkC,MAVuB,gBAUfC,SAVe,gCAWEnC,QAAQ,CAAC,EAAD,CAXV,2CAWvBoC,QAXuB,gBAWbC,WAXa,gBAa9B,GAAMC,CAAAA,OAAO,CAAGpC,UAAU,EAA1B,CAEAH,SAAS,CAAC,UAAM,wBACQI,WAAW,CAACoC,KAAZ,CAAkBxB,QAAQ,CAACyB,MAA3B,CADR,CACPxB,IADO,oBACPA,IADO,CACDE,IADC,oBACDA,IADC,CAGfL,MAAM,CAAGT,EAAE,CAACQ,QAAD,CAAX,CACA6B,OAAO,CAACC,GAAR,CAAY7B,MAAZ,CAAoB,QAApB,EAEAM,OAAO,CAACD,IAAD,CAAP,CACAD,OAAO,CAACD,IAAD,CAAP,CAEAH,MAAM,CAAC8B,IAAP,CAAY,MAAZ,CAAoB,CAAE3B,IAAI,CAAJA,IAAF,CAAQE,IAAI,CAAJA,IAAR,CAApB,CAAoC,SAACQ,KAAD,CAAW,CAC9C,GAAIA,KAAJ,CAAW,CACVC,QAAQ,CAAC,IAAD,CAAR,CACA,CACDI,UAAU,CAAC,KAAD,CAAV,CACA,CALD,EAOA,GAAIG,MAAJ,CAAY,CACXrB,MAAM,CAAC8B,IAAP,CAAY,QAAZ,CAAsB3B,IAAtB,EACA,CAEDH,MAAM,CAAC+B,EAAP,CAAU,eAAV,CAA2B,SAAClB,KAAD,CAAW,CACrCmB,KAAK,CAAC,qDAAD,CAAL,CACAhC,MAAM,CAACiC,UAAP,GACAR,OAAO,CAACS,IAAR,CAAa,GAAb,EACA,CAJD,EAMA,CA1BQ,CA0BN,CAACnC,QAAD,CAAWG,QAAQ,CAACyB,MAApB,CA1BM,CAAT,CA4BAzC,SAAS,CAAC,UAAM,CACfc,MAAM,CAAC+B,EAAP,CAAU,SAAV,CAAqB,SAAAtB,OAAO,CAAI,CAC/BG,WAAW,CAAC,SAAAD,QAAQ,qCAAQA,QAAR,GAAkBF,OAAlB,IAAT,CAAX,CACA,CAFD,EAIAT,MAAM,CAAC+B,EAAP,CAAU,UAAV,CAAsB,eAAe,IAAZxB,CAAAA,KAAY,OAAZA,KAAY,CACpCC,QAAQ,CAACD,KAAD,CAAR,CACA,CAFD,EAGA,CARQ,CAQN,EARM,CAAT,CAUArB,SAAS,CAAC,UAAM,CACfc,MAAM,CAAC+B,EAAP,CAAU,QAAV,CAAoB,SAAAR,QAAQ,CAAI,CAC/BC,WAAW,CAACD,QAAQ,CAACY,IAAV,CAAX,CACA,CAFD,EAIA,CALQ,CAKN,CAAChC,IAAD,CAAOoB,QAAP,CALM,CAAT,CAOA,GAAMa,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACf,MAAD,CAAY,CAC5BrB,MAAM,CAAC8B,IAAP,CAAY,QAAZ,CAAsB3B,IAAtB,CAA4BkB,MAA5B,CAAoC,iBAAMG,CAAAA,WAAW,CAAC,EAAD,CAAjB,EAApC,EACA,CAFD,CAIA,GAAMa,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACC,KAAD,CAAW,CAC9BA,KAAK,CAACC,cAAN,GACA,GAAMC,CAAAA,IAAI,CAAG,GAAIC,CAAAA,IAAJ,GAAWC,kBAAX,EAAb,CAEA,GAAIjC,OAAJ,CAAa,CACZT,MAAM,CAAC8B,IAAP,CAAY,aAAZ,CAA2BrB,OAA3B,CAAoC+B,IAApC,CAA0C,iBAAM9B,CAAAA,UAAU,CAAC,EAAD,CAAhB,EAA1C,EACA,CACD,CAPD,CASA,mBACC,YAAK,SAAS,CAAES,SAAS,CAAG,iBAAH,CAAuB,kBAAhD,UACEF,OAAO,cACP,aAAK,KAAK,CAAE,CAAE0B,MAAM,CAAE,QAAV,CAAZ,wBACC,KAAC,SAAD,EACC,IAAI,CAAE,GADP,CAEC,KAAK,CAAE,SAFR,CAGC,OAAO,CAAE1B,OAHV,EADD,cAMC,UAAG,SAAS,CAAC,eAAb,4CAND,GADO,cAUP,YAAK,KAAK,CAAE,CAAE2B,KAAK,CAAE,MAAT,CAAiBC,MAAM,CAAE,MAAzB,CAAZ,UACEhC,KAAK,cAAG,aAAK,SAAS,CAAC,aAAf,wBACR,wCAAM,YAAK,GAAG,CAAEf,QAAV,CAAoB,GAAG,CAAC,OAAxB,EAAN,GADQ,cAER,KAAC,IAAD,EAAM,EAAE,CAAE,GAAV,uBACC,4CADD,EAFQ,GAAH,cAOL,aAAK,SAAS,CAAC,WAAf,wBACC,KAAC,aAAD,EAAe,KAAK,CAAES,KAAtB,CAA6B,QAAQ,CAAEJ,IAAvC,CAA6C,IAAI,CAAEE,IAAnD,CAAyD,WAAW,CAAEW,WAAtE,CAAmF,IAAI,CAAED,QAAzF,CAAmG,SAAS,CAAEI,SAA9G,CAAyH,YAAY,CAAEC,YAAvI,EADD,cAEC,YAAK,SAAS,CAAC,iBAAf,uBACC,aAAK,SAAS,CAAC,kBAAf,wBACC,KAAC,OAAD,EAAS,IAAI,CAAEf,IAAf,CAAqB,WAAW,CAAEW,WAAlC,CAA+C,IAAI,CAAED,QAArD,CAA+D,SAAS,CAAEI,SAA1E,EADD,cAEC,KAAC,QAAD,EAAU,QAAQ,CAAER,QAApB,CAA8B,IAAI,CAAER,IAApC,CAA0C,SAAS,CAAEgB,SAArD,EAFD,CAGEI,QAAQ,cAAG,UAAG,SAAS,CAAEJ,SAAS,CAAG,gCAAH,CAAsC,iCAA7D,UAAiGI,QAAjG,EAAH,CAAoH,IAH9H,cAKC,KAAC,SAAD,EAAW,UAAU,CAAEb,UAAvB,CAAmC,SAAS,CAAES,SAA9C,EALD,cAMC,KAAC,KAAD,EAAO,OAAO,CAAEV,OAAhB,CAAyB,UAAU,CAAEC,UAArC,CAAiD,WAAW,CAAE2B,WAA9D,CAA2E,SAAS,CAAElB,SAAtF,CAAiG,SAAS,CAAEG,SAA5G,CAAuH,QAAQ,CAAEc,QAAjI,EAND,GADD,EAFD,GARF,EAXF,EADD,CAsCA,CA/GD,CAiHA,cAAenC,CAAAA,IAAf","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport queryString from 'query-string';\nimport io from 'socket.io-client';\n\nimport InfoBar from '../InforBar/InforBar';\nimport InputMenu from '../InputMenu/InputMenu';\nimport Input from '../Input/Input';\nimport Messages from '../Messages/Messages';\nimport TextContainer from '../TextContainer/TextContainer';\nimport DotLoader from \"react-spinners/DotLoader\";\nimport errorImg from '../../assets/images/error.png';\nimport './Chat.scss';\n\nconst ENDPOINT = 'https://chat-application23.herokuapp.com/'\n//const ENDPOINT = 'localhost:5000';\n\nlet socket;\n\nconst Chat = ({ location }) => {\n\tconst [name, setName] = useState('');\n\tconst [room, setRoom] = useState('');\n\tconst [users, setUsers] = useState('');\n\tconst [message, setMessage] = useState('');\n\tconst [messages, setMessages] = useState([]);\n\tconst [error, setError] = useState(false);\n\tconst [openMenu, setOpenMenu] = useState(true)\n\tconst [loading, setLoading] = useState(true);\n\tconst [themeDark, setThemeDark] = useState(false);\n\tconst [typing, setTyping] = useState(false);\n\tconst [typeMess, setTypeMess] = useState('');\n\n\tconst history = useHistory();\n\n\tuseEffect(() => {\n\t\tconst { name, room } = queryString.parse(location.search);\n\n\t\tsocket = io(ENDPOINT);\n\t\tconsole.log(socket, 'SOCKET');\n\n\t\tsetRoom(room);\n\t\tsetName(name)\n\n\t\tsocket.emit('join', { name, room }, (error) => {\n\t\t\tif (error) {\n\t\t\t\tsetError(true)\n\t\t\t}\n\t\t\tsetLoading(false);\n\t\t});\n\n\t\tif (typing) {\n\t\t\tsocket.emit('typing', name);\n\t\t}\n\n\t\tsocket.on('connect_error', (error) => {\n\t\t\talert('Server is currently down :( Please come back later!');\n\t\t\tsocket.disconnect()\n\t\t\thistory.push('/')\n\t\t});\n\n\t}, [ENDPOINT, location.search]);\n\n\tuseEffect(() => {\n\t\tsocket.on('message', message => {\n\t\t\tsetMessages(messages => [...messages, message]);\n\t\t});\n\n\t\tsocket.on(\"roomData\", ({ users }) => {\n\t\t\tsetUsers(users);\n\t\t});\n\t}, []);\n\n\tuseEffect(() => {\n\t\tsocket.on('typing', typeMess => {\n\t\t\tsetTypeMess(typeMess.data);\n\t\t});\n\n\t}, [name, typeMess])\n\n\tconst isTyping = (typing) => {\n\t\tsocket.emit('typing', name, typing, () => setTypeMess(''))\n\t}\n\n\tconst sendMessage = (event) => {\n\t\tevent.preventDefault();\n\t\tconst time = new Date().toLocaleTimeString();\n\n\t\tif (message) {\n\t\t\tsocket.emit('sendMessage', message, time, () => setMessage(''));\n\t\t}\n\t}\n\n\treturn (\n\t\t<div className={themeDark ? 'chat chat__dark' : 'chat chat__light'}>\n\t\t\t{loading ?\n\t\t\t\t<div style={{ margin: \"0 auto\" }}>\n\t\t\t\t\t<DotLoader\n\t\t\t\t\t\tsize={150}\n\t\t\t\t\t\tcolor={\"#69D1D1\"}\n\t\t\t\t\t\tloading={loading}\n\t\t\t\t\t/>\n\t\t\t\t\t<p className=\"chat__loading\">Setting up your chat room ... </p>\n\t\t\t\t</div>\n\t\t\t\t:\n\t\t\t\t<div style={{ width: \"100%\", height: \"100%\" }}>\n\t\t\t\t\t{error ? <div className=\"chat__error\">\n\t\t\t\t\t\t<div> <img src={errorImg} alt=\"error\"></img></div>\n\t\t\t\t\t\t<Link to={\"/\"}>\n\t\t\t\t\t\t\t<button> Join TeleChat! </button>\n\t\t\t\t\t\t</Link>\n\n\t\t\t\t\t</div> :\n\t\t\t\t\t\t<div className=\"chatInner\">\n\t\t\t\t\t\t\t<TextContainer users={users} userName={name} room={room} setOpenMenu={setOpenMenu} menu={openMenu} themeDark={themeDark} setThemeDark={setThemeDark} />\n\t\t\t\t\t\t\t<div className=\"chatInner__main\">\n\t\t\t\t\t\t\t\t<div className=\"chatInner__inner\">\n\t\t\t\t\t\t\t\t\t<InfoBar room={room} setOpenMenu={setOpenMenu} menu={openMenu} themeDark={themeDark} />\n\t\t\t\t\t\t\t\t\t<Messages messages={messages} name={name} themeDark={themeDark} />\n\t\t\t\t\t\t\t\t\t{typeMess ? <p className={themeDark ? \"chatInner__typing dark__typing\" : \"chatInner__typing light__typing\"}>{typeMess}</p> : null}\n\n\t\t\t\t\t\t\t\t\t<InputMenu setMessage={setMessage} themeDark={themeDark} />\n\t\t\t\t\t\t\t\t\t<Input message={message} setMessage={setMessage} sendMessage={sendMessage} themeDark={themeDark} setTyping={setTyping} isTyping={isTyping} />\n\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t\t</div>}\n\t\t</div>\n\t);\n}\n\nexport default Chat;\n"]},"metadata":{},"sourceType":"module"}