{"ast":null,"code":"import _toConsumableArray from\"/Users/nirmaperera/Desktop/chat-app/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/nirmaperera/Desktop/chat-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useEffect,useState}from'react';import queryString from'query-string';import io from'socket.io-client';import{Link}from'react-router-dom';import InfoBar from'../InforBar/InforBar';import errorImg from'../../images/error.png';import Input from'../Input/Input';import Messages from'../Messages/Messages';import TextContainer from'../TextContainer/TextContainer';import'./Chat.css';import InputMenu from'../InputMenu/InputMenu';var ENDPOINT='https://chat-application23.herokuapp.com/';//const ENDPOINT = 'localhost:5000';\nvar socket;var Chat=function Chat(_ref){var location=_ref.location;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),room=_useState4[0],setRoom=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),users=_useState6[0],setUsers=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),message=_useState8[0],setMessage=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),messages=_useState10[0],setMessages=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),error=_useState12[0],setError=_useState12[1];var _useState13=useState(true),_useState14=_slicedToArray(_useState13,2),openMenu=_useState14[0],setOpenMenu=_useState14[1];window.scrollTo(0,0);useEffect(function(){var _queryString$parse=queryString.parse(location.search),name=_queryString$parse.name,room=_queryString$parse.room;socket=io(ENDPOINT);setRoom(room);setName(name);socket.emit('join',{name:name,room:room},function(error){if(error){setError(true);alert(error);}});},[ENDPOINT,location.search]);useEffect(function(){socket.on('message',function(message){setMessages(function(messages){return[].concat(_toConsumableArray(messages),[message]);});});socket.on(\"roomData\",function(_ref2){var users=_ref2.users;setUsers(users);});},[]);var sendMessage=function sendMessage(event){event.preventDefault();console.log(message,'MESSAGES');if(message){socket.emit('sendMessage',message,function(){return setMessage('');});}};console.log(openMenu,\"OPen menu\");return/*#__PURE__*/_jsx(\"div\",{className:\"outerContainer\",children:error?/*#__PURE__*/_jsxs(\"div\",{className:\"error\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\" \",/*#__PURE__*/_jsx(\"img\",{src:errorImg})]}),/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsx(\"button\",{children:\" Join TeleChat! \"})})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"innerContainer\",children:[/*#__PURE__*/_jsx(TextContainer,{users:users,name:name,room:room,setOpenMenu:setOpenMenu,menu:openMenu}),/*#__PURE__*/_jsx(\"div\",{className:\"message__container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(InfoBar,{room:room,setOpenMenu:setOpenMenu,menu:openMenu}),/*#__PURE__*/_jsx(Messages,{messages:messages,name:name}),/*#__PURE__*/_jsx(InputMenu,{setMessage:setMessage}),/*#__PURE__*/_jsx(Input,{message:message,setMessage:setMessage,sendMessage:sendMessage})]})})]})});};export default Chat;","map":{"version":3,"sources":["/Users/nirmaperera/Desktop/chat-app/client/src/components/Chat/Chat.js"],"names":["React","useEffect","useState","queryString","io","Link","InfoBar","errorImg","Input","Messages","TextContainer","InputMenu","ENDPOINT","socket","Chat","location","name","setName","room","setRoom","users","setUsers","message","setMessage","messages","setMessages","error","setError","openMenu","setOpenMenu","window","scrollTo","parse","search","emit","alert","on","sendMessage","event","preventDefault","console","log"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport queryString from 'query-string';\nimport io from 'socket.io-client';\nimport { Link } from 'react-router-dom';\n\nimport InfoBar from '../InforBar/InforBar';\nimport errorImg from '../../images/error.png';\n\nimport Input from '../Input/Input';\nimport Messages from '../Messages/Messages';\nimport TextContainer from '../TextContainer/TextContainer';\n\n\nimport './Chat.css';\nimport InputMenu from '../InputMenu/InputMenu';\n\nconst ENDPOINT = 'https://chat-application23.herokuapp.com/'\n//const ENDPOINT = 'localhost:5000';\nlet socket;\n\nconst Chat = ({ location }) => {\n    const [name, setName] = useState('');\n    const [room, setRoom] = useState('');\n    const [users, setUsers] = useState('');\n    const [message, setMessage] = useState('');\n    const [messages, setMessages] = useState([]);\n    const [error, setError] = useState(false);\n    const [openMenu, setOpenMenu] = useState(true)\n    window.scrollTo(0, 0);\n\n    useEffect(() => {\n        const { name, room } = queryString.parse(location.search);\n\n        socket = io(ENDPOINT);\n\n        setRoom(room);\n        setName(name)\n\n        socket.emit('join', { name, room }, (error) => {\n            if (error) {\n                setError(true)\n                alert(error);\n\n            }\n        });\n    }, [ENDPOINT, location.search]);\n\n    useEffect(() => {\n        socket.on('message', message => {\n            setMessages(messages => [...messages, message]);\n        });\n\n        socket.on(\"roomData\", ({ users }) => {\n            setUsers(users);\n        });\n    }, []);\n\n    const sendMessage = (event) => {\n        event.preventDefault();\n        console.log(message, 'MESSAGES')\n\n        if (message) {\n            socket.emit('sendMessage', message, () => setMessage(''));\n        }\n    }\n\n    console.log(openMenu, \"OPen menu\");\n    return (\n        <div className=\"outerContainer\">\n            {error ? <div className=\"error\">\n                <div> <img src={errorImg}></img></div>\n                <Link to={\"/\"}>\n                    <button> Join TeleChat! </button>\n                </Link>\n\n\n            </div> :\n                <div className=\"innerContainer\">\n\n                    <TextContainer users={users} name={name} room={room} setOpenMenu={setOpenMenu} menu={openMenu} />\n                    <div className=\"message__container\">\n\n                        <div className=\"container\">\n                            <InfoBar room={room} setOpenMenu={setOpenMenu} menu={openMenu} />\n                            <Messages messages={messages} name={name} />\n                            <InputMenu setMessage={setMessage} />\n                            <Input message={message} setMessage={setMessage} sendMessage={sendMessage} />\n                        </div>\n                    </div>\n                </div>\n            }\n\n        </div>\n    );\n}\n\nexport default Chat;\n"]},"metadata":{},"sourceType":"module"}